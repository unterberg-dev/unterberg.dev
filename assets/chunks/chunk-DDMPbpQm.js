function N(e){return Array.from(new Set(e))}const O="0.4.216",$={projectName:"Vike",projectVersion:O},L=`_${$.projectName.toLowerCase()}`;function j(e,t){const n=V();return n[e]=n[e]||t}function V(){return globalThis[L]=globalThis[L]||{}}const g=new Proxy({},{get:(e,t)=>n=>t==="code"?`\`${n}\``:t==="string"?`'${n}'`:n}),d=j("assertSingleInstance.ts",{instances:[],alreadyLogged:new Set}),U="Client runtime of both Server Routing and Client Routing loaded https://vike.dev/client-runtimes-conflict",_="Client runtime loaded twice https://vike.dev/client-runtime-duplicated";function I(){{const e=N(d.instances);H(e.length<=1,`vike@${g.bold(e[0])} and vike@${g.bold(e[1])} loaded but only one version should be loaded`)}d.checkSingleInstance&&d.instances.length>1&&T(!1,_,{onlyOnce:!0,showStackTrace:!0})}function ee(e){T(d.isClientRouting!==!1,U,{onlyOnce:!0,showStackTrace:!0}),T(d.isClientRouting===void 0,_,{onlyOnce:!0,showStackTrace:!0}),d.isClientRouting=!0,d.checkSingleInstance=!0,I()}function A(){d.instances.push($.projectVersion),I()}function H(e,t){if(e)return;const n=`[vike][Wrong Usage] ${t}`;throw new Error(n)}function T(e,t,{onlyOnce:n,showStackTrace:o}){if(e)return;const r=`[vike][Warning] ${t}`;if(n){const{alreadyLogged:i}=d,s=n===!0?r:n;if(i.has(s))return;i.add(s)}console.warn(o?new Error(r):r)}function q(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function y(e,t){const n=new Error(e);return q()&&(n.stack=G(n.stack,t)),n}function G(e,t){if(!e)return e;const n=z(e);let o=0;return n.filter(i=>i.includes(" (internal/")||i.includes(" (node:internal")?!1:o<t&&J(i)?(o++,!1):!0).join(`
`)}function J(e){return e.startsWith("    at ")}function z(e){return e.split(/\r?\n/)}function D(e){return typeof e=="object"&&e!==null}const c=j("utils/assert.ts",{alreadyLogged:new Set,logger(e,t){t==="info"?console.log(e):console.warn(e)},showStackTraceList:new WeakSet});A();const F="[vike]",K=`[vike@${$.projectVersion}]`,v=2;function te(e,t){var s;if(e)return;const n=(()=>{if(!t)return null;const a=typeof t=="string"?t:JSON.stringify(t);return g.dim(`Debug info (for Vike maintainers; you can ignore this): ${a}`)})();let r=[`You stumbled upon a Vike bug. Go to ${g.blue("https://github.com/vikejs/vike/issues/new")} and copy-paste this error. A maintainer will fix the bug (usually within 24 hours).`,n].filter(Boolean).join(" ");r=p(r),r=S(r,"Bug"),r=k(r,!0);const i=y(r,v);throw(s=c.onBeforeLog)==null||s.call(c),i}function ne(e,t,{showStackTrace:n}={}){var r;if(e)return;n=n||c.alwaysShowStackTrace,t=p(t),t=S(t,"Wrong Usage"),t=k(t);const o=y(t,v);throw n&&c.showStackTraceList.add(o),(r=c.onBeforeLog)==null||r.call(c),o}function Y(e){return e=p(e),e=S(e,"Error"),e=k(e),y(e,v)}function Q(e,t,{onlyOnce:n,showStackTrace:o}){var r;if(!e){if(o=o||c.alwaysShowStackTrace,t=p(t),t=S(t,"Warning"),t=k(t),n){const{alreadyLogged:i}=c,s=n===!0?t:n;if(i.has(s))return;i.add(s)}if((r=c.onBeforeLog)==null||r.call(c),o){const i=y(t,v);c.showStackTraceList.add(i),c.logger(i,"warn")}else c.logger(t,"warn")}}function re(e,t,{onlyOnce:n}){var o;if(t=p(t),t=k(t),n){const{alreadyLogged:r}=c,i=t;if(r.has(i))return;r.add(i)}(o=c.onBeforeLog)==null||o.call(c),c.logger(t,"info")}function S(e,t){let n=`[${t}]`;const o=t==="Warning"?"yellow":"red";return n=g.bold(g[o](n)),`${n}${e}`}function p(e){return e.startsWith("[")?e:` ${e}`}function k(e,t=!1){return`${t?K:F}${e}`}function C(e){const t=e/1e3;if(t<120){const n=W(t);return`${n} second${P(n)}`}{const n=t/60,o=W(n);return`${o} minute${P(o)}`}}function W(e){let t=e.toFixed(1);return t.endsWith(".0")&&(t=t.slice(0,-2)),t}function P(e){return e==="1"?"":"s"}const E=j("utils/executeHook.ts",{userHookErrors:new WeakMap,pageContext:null});function oe(e,t,n){const{hookName:o,hookFilePath:r,hookTimeout:{error:i,warning:s}}=t;let a,u;const h=new Promise((f,B)=>{a=b=>{m(),f(b)},u=b=>{m(),B(b)}}),m=()=>{l&&clearTimeout(l),w&&clearTimeout(w)},l=x(s)&&setTimeout(()=>{Q(!1,`The ${o}() hook defined by ${r} is slow: it's taking more than ${C(s)} (https://vike.dev/hooksTimeout)`,{onlyOnce:!1})},s),w=x(i)&&setTimeout(()=>{const f=Y(`The ${o}() hook defined by ${r} timed out: it didn't finish after ${C(i)} (https://vike.dev/hooksTimeout)`);u(f)},i);return(async()=>{try{X(n);const f=await e();a(f)}catch(f){D(f)&&E.userHookErrors.set(f,{hookName:o,hookFilePath:r}),u(f)}})(),h}function x(e){return!!e&&e!==1/0}function X(e){E.pageContext=e,Promise.resolve().then(()=>{E.pageContext=null})}const Z="modulepreload",M=function(e){return"/"+e},R={},ie=function(t,n,o){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));r=Promise.allSettled(n.map(u=>{if(u=M(u),u in R)return;R[u]=!0;const h=u.endsWith(".css"),m=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${m}`))return;const l=document.createElement("link");if(l.rel=h?"stylesheet":Z,h||(l.as="script"),l.crossOrigin="",l.href=u,a&&l.setAttribute("nonce",a),document.head.appendChild(l),h)return new Promise((w,f)=>{l.addEventListener("load",w),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return r.then(s=>{for(const a of s||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})};export{ie as _,ne as a,g as b,Q as c,te as d,oe as e,Y as f,j as g,re as h,D as i,ee as j,X as p,N as u};
